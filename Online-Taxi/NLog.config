<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true"
      throwExceptions="true">

  <variable name="logDirectory" value="${basedir}/Logs" />

  <extensions>
    <add assembly="NLog.Targets.Seq"/>
    <add assembly="NLog.Slack" />
  </extensions>

  <targets async="true">
    <target name="textFile"
               xsi:type="File"
               layout="${longdate} ${threadid:padding=4} ${level:uppercase=true:padding=5} ${logger} ${message} ${exception:format=tostring} ${event-properties:item=Error}"
               fileName="${logDirectory}/log.${shortdate}.txt"
               concurrentWrites="true"
               createDirs="true"
               autoFlush="true" />

    <target name="seq" xsi:type="BufferingWrapper" bufferSize="1000" flushTimeout="2000">
      <target xsi:type="Seq" serverUrl="https://seq.dayaapp.ir" apiKey="" />
    </target>

    <target xsi:type="Slack"
          name="slackTarget"
          layout="${threadid:padding=4} ${level:uppercase=true:padding=5} ${logger}"
          webHookUrl="https://hooks.slack.com/services/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"
          compact="false">

      <field name="Level" layout="${level}" />
      <field name="URL" layout="${message}" />
      <field name="Properties" layout="${event-properties:item=Params}" />
      <field name="Error" layout="${exception:format=tostring} ${event-properties:item=Error}" />
      <field name="Machine Name" layout="${machinename}" />
    </target>

  </targets>
  <rules>
    <logger name="*" writeTo="textFile,seq" minlevel="Trace" />
    <logger name="*" writeTo="slackTarget" minlevel="Error" />
  </rules>
</nlog>